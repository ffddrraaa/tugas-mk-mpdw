---
title: "Tugas Praktikum MPDW 1"
author: "Fedora"
date: "2023-08-30"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Library yang digunakan
```{r}
library("forecast")
library("graphics")
library("TTR")
library("TSA")
library("rio")
```

#Impor Data
```{r}
data.turis <- import("Data Pendatang Mancanegara di Bali - Sheet1.csv")
data.turis
```

#Eksplorasi Data
```{r}
View(data.turis)
str(data.turis)
dim(data.turis)
```

Mengubah data agar terbaca sebagai data deret waktu dengan fungsi `ts()` .
```{r}
dataturis.ts <- ts(data.turis$Jumlah)
dataturis.ts
```

Menampilkan ringkasan data
```{r}
summary(dataturis.ts)
```

Membuat plot data deret waktu
```{r}
ts.plot(dataturis.ts, xlab="Time Period", ylab="Pendatang Mancanegara", 
        main = "Time Series Plot")
points(dataturis.ts)
```

#Single Moving Average & Double Moving Average
## Pembagian Data

Pembagian data latih dan data uji dilakukan dengan perbandingan 80% data latih dan 20% data uji.
```{r}
#membagi data latih dan data uji
ma_training <- data.turis[1:140,]
ma_testing <- data.turis[141:174,]
ts.train_ma <- ts(ma_training$Jumlah)
ts.test_ma <- ts(ma_testing$Jumlah)
```

## Eksplorasi Data
Eksplorasi data dilakukan pada keseluruhan data, data latih serta data uji menggunakan plot data deret waktu.
```{r}
#eksplorasi keseluruhan data
plot(dataturis.ts, col="red",main="Plot semua data")
points(dataturis.ts)

#eksplorasi data latih
plot(ts.train_ma, col="blue",main="Plot data latih")
points(ts.train_ma)

#eksplorasi data uji
plot(ts.test_ma, col="blue",main="Plot data uji")
points(ts.test_ma)
```

Eksplorasi data juga dapat dilakukan menggunakan package `ggplot2` dengan terlebih dahulu memanggil library *package* `ggplot2`.
```{r}
#Eksplorasi dengan GGPLOT
library(ggplot2)
ggplot() + 
  geom_line(data = ma_training, aes(x = Periode, y = Jumlah, col = "Data Latih")) +
  geom_line(data = ma_testing, aes(x = Periode, y = Jumlah, col = "Data Uji")) +
  labs(x = "Periode Waktu", y = "Jumlah", color = "Legend") +
  scale_colour_manual(name="Keterangan:", breaks = c("Data Latih", "Data Uji"),
                      values = c("blue", "red")) + 
  theme_bw() + theme(legend.position = "bottom",
                     plot.caption = element_text(hjust=0.5, size=12))
```